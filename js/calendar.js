calDateFormat="dd/mm/yyyy",topBackground="white",bottomBackground="white",tableBGColor="#959595",cellColor="white",headingCellColor="white",headingTextColor="navy",dateColor="blue",focusColor="#ff0000",hoverColor="#ff0000",fontStyle="8pt Verdana, helvetica",headingFontStyle="bold 8pt Verdana, helvetica",bottomBorder=!1,tableBorder=1;var isNav=!1,isIE=!1;function setDateField(e,a){calDateField=e,inDate=e.value,setInitialDate(a),calDocTop=buildTopCalFrame(),calDocBottom=buildBottomCalFrame()}function setInitialDate(e){calDate=new Date(e),isNaN(calDate)&&(calDate=new Date),calDay=calDate.getDate(),calDate.setDate(1)}function showCalendar(e){setDateField(e),calDocFrameset="<HTML><HEAD></HEAD>\n<FRAMESET ROWS='70,*' FRAMEBORDER='0'>\n<FRAME NAME='topCalFrame' SRC='javascript:parent.opener.calDocTop' SCROLLING='no'>\n<FRAME NAME='bottomCalFrame' SRC='javascript:parent.opener.calDocBottom' SCROLLING='no'>\n</FRAMESET>\n",top.newWin=window.open("javascript:parent.opener.calDocFrameset","calWin",winPrefs),top.newWin.focus()}function buildTopCalFrame(){return"<HTML><HEAD></HEAD><BODY BGCOLOR='"+topBackground+"'><FORM NAME='calControl' onSubmit='return false;'><CENTER><TABLE CELLPADDING=0 CELLSPACING=1 BORDER=0><TR><TD COLSPAN=7><CENTER>"+getMonthSelect()+"<INPUT NAME='year' VALUE='"+calDate.getFullYear()+"'TYPE=TEXT SIZE=4 MAXLENGTH=4 onChange='parent.opener.setYear()'></CENTER></TD></TR><TR><TD COLSPAN=7><INPUT TYPE=BUTTON NAME='previousYear' VALUE='<<'    onClick='parent.opener.setPreviousYear()'><INPUT TYPE=BUTTON NAME='previousMonth' VALUE=' < '   onClick='parent.opener.setPreviousMonth()'><INPUT TYPE=BUTTON NAME='today' VALUE='Today' onClick='parent.opener.setToday()'><INPUT TYPE=BUTTON NAME='nextMonth' VALUE=' > '   onClick='parent.opener.setNextMonth()'><INPUT TYPE=BUTTON NAME='nextYear' VALUE='>>'    onClick='parent.opener.setNextYear()'></TD></TR></TABLE></CENTER></FORM></BODY></HTML>"}function buildBottomCalFrame(){var e=calendarBegin;month=calDate.getMonth(),year=calDate.getFullYear(),day=calDay;var a=0,t=getDaysInMonth();day>t&&(day=t);var o=new Date(year,month,1).getDay();t+=o;var r=0;for(a=0;a<o;a++)e+=blankCell,r++;var n=0;for(a=o;a<t;a++){padding=a-o+1<10?"&nbsp;&nbsp;":"&nbsp;",(n=a-o+1)==day?"focusDay":"weekDay",e+="<TD align=center bgcolor='"+cellColor+"'><a class='lnkblu' href='javascript:parent.opener.returnDate("+n+')\' title="Click here for select this date">'+padding+n+"&nbsp;</a></TD>",++r%7==0&&(e+="</TR><TR>")}for(a=t;a<42;a++)e+=blankCell,++r%7==0&&(e+="</TR>",a<41&&(e+="<TR>"));return e+=calendarEnd}function writeCalendar(){calDocBottom=buildBottomCalFrame(),top.newWin.frames.bottomCalFrame.document.open(),top.newWin.frames.bottomCalFrame.document.write(calDocBottom),top.newWin.frames.bottomCalFrame.document.close()}function setToday(){calDate=new Date;var e=calDate.getMonth(),a=calDate.getFullYear();top.newWin.frames.topCalFrame.document.calControl.month.selectedIndex=e,top.newWin.frames.topCalFrame.document.calControl.year.value=a,writeCalendar()}function setYear(){var e=top.newWin.frames.topCalFrame.document.calControl.year.value;isFourDigitYear(e)?(calDate.setFullYear(e),writeCalendar()):(top.newWin.frames.topCalFrame.document.calControl.year.focus(),top.newWin.frames.topCalFrame.document.calControl.year.select())}function setCurrentMonth(){var e=top.newWin.frames.topCalFrame.document.calControl.month.selectedIndex;calDate.setMonth(e),writeCalendar()}function setPreviousYear(){var e=top.newWin.frames.topCalFrame.document.calControl.year.value;isFourDigitYear(e)&&e>1e3&&(e--,calDate.setFullYear(e),top.newWin.frames.topCalFrame.document.calControl.year.value=e,writeCalendar())}function setPreviousMonth(){var e=top.newWin.frames.topCalFrame.document.calControl.year.value;if(isFourDigitYear(e)){var a=top.newWin.frames.topCalFrame.document.calControl.month.selectedIndex;0==a?(a=11,e>1e3&&(e--,calDate.setFullYear(e),top.newWin.frames.topCalFrame.document.calControl.year.value=e)):a--,calDate.setMonth(a),top.newWin.frames.topCalFrame.document.calControl.month.selectedIndex=a,writeCalendar()}}function setNextMonth(){var e=top.newWin.frames.topCalFrame.document.calControl.year.value;if(isFourDigitYear(e)){var a=top.newWin.frames.topCalFrame.document.calControl.month.selectedIndex;11==a?(a=0,e++,calDate.setFullYear(e),top.newWin.frames.topCalFrame.document.calControl.year.value=e):a++,calDate.setMonth(a),top.newWin.frames.topCalFrame.document.calControl.month.selectedIndex=a,writeCalendar()}}function setNextYear(){var e=top.newWin.frames.topCalFrame.document.calControl.year.value;isFourDigitYear(e)&&(e++,calDate.setFullYear(e),top.newWin.frames.topCalFrame.document.calControl.year.value=e,writeCalendar())}function getDaysInMonth(){var e,a=calDate.getMonth()+1,t=calDate.getFullYear();return 1==a||3==a||5==a||7==a||8==a||10==a||12==a?e=31:4==a||6==a||9==a||11==a?e=30:2==a&&(e=isLeapYear(t)?29:28),e}function isLeapYear(e){return e%4==0&&e%100!=0||e%400==0}function isFourDigitYear(e){if(4==e.length)return!0;top.newWin.frames.topCalFrame.document.calControl.year.value=calDate.getFullYear(),top.newWin.frames.topCalFrame.document.calControl.year.select(),top.newWin.frames.topCalFrame.document.calControl.year.focus()}function getMonthSelect(){"fr"==selectedLanguage?monthArray=new Array("Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Aout","Septembre","Octobre","Novembre","Décembre"):"de"==selectedLanguage?monthArray=new Array("Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"):"es"==selectedLanguage?monthArray=new Array("Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"):monthArray=new Array("January","February","March","April","May","June","July","August","September","October","November","December");var e=calDate.getMonth();for(i in monthSelect="<SELECT NAME='month' onChange='parent.opener.setCurrentMonth()'>",monthArray)i==e?monthSelect+="<OPTION SELECTED>"+monthArray[i]+"\n":monthSelect+="<OPTION>"+monthArray[i]+"\n";return monthSelect+="</SELECT>",monthSelect}function createWeekdayList(){"fr"==selectedLanguage?(weekdayList=new Array("Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"),weekdayArray=new Array("Di","Lu","Ma","Me","Je","Ve","Sa")):"de"==selectedLanguage?(weekdayList=new Array("Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"),weekdayArray=new Array("So","Mo","Di","Mi","Do","Fr","Sa")):"es"==selectedLanguage?(weekdayList=new Array("Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"),weekdayArray=new Array("Do","Lu","Ma","Mi","Ju","Vi","Sa")):(weekdayList=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"),weekdayArray=new Array("Su","Mo","Tu","We","Th","Fr","Sa"));var e="<TR BGCOLOR='"+headingCellColor+"'>";for(i in weekdayArray)e+="<TD class='heading' align=center>"+weekdayArray[i]+"</TD>";return e+="</TR>"}function buildCalParts(){weekdays=createWeekdayList(),blankCell="<TD align=center bgcolor='"+cellColor+"'>&nbsp;&nbsp;&nbsp;</TD>",calendarBegin="<HTML><HEAD><STYLE type='text/css'><--TD.heading { text-decoration: none; color:headingTextColor; font:"+headingFontStyle+";}A.focusDay:link { color:"+focusColor+"; text-decoration: none; font: "+fontStyle+"; }A.focusDay:hover { color: "+focusColor+"; text-decoration: none; font: "+fontStyle+"; }A.lnkblu {font-family : Verdana; font-weight : bold; font-size : 8pt; color : #00207b; text-decoration : none; }A.weekday:link { color: "+dateColor+"; text-decoration: none; font: "+fontStyle+"; }A.weekday:hover { color: "+hoverColor+"; font: "+fontStyle+"; }--\x3e</STYLE></HEAD><BODY BGCOLOR='"+bottomBackground+"' <CENTER>",isNav&&(calendarBegin+="<TABLE CELLPADDING=2 CELLSPACING=0 BORDER="+tableBorder+" ALIGN=CENTER BGCOLOR='"+tableBGColor+'\'  bordercolorlight="#999999" bordercolordark="#ffffff"><TR><TD>'),calendarBegin+="<TABLE CELLPADDING=2 CELLSPACING=0 BORDER="+tableBorder+" ALIGN=CENTER BGCOLOR='"+tableBGColor+'\' bordercolorlight="#999999" bordercolordark="#ffffff">'+weekdays+"<TR>",calendarEnd="",bottomBorder&&(calendarEnd+="<TR></TR>"),isNav&&(calendarEnd+="</TD></TR></TABLE>"),calendarEnd+="</TABLE></CENTER></BODY></HTML>"}function jsReplace(e,a,o){return e?-1!=e.indexOf(a)?(t=e.split(a),t.join(o)):e:""}function doNothing(){}function makeTwoDigit(e){var a=parseInt(e,10);return a<10?"0"+a:a}function returnDate(e){calDate.setDate(e);var a=calDate.getDate(),t=calDate.getMonth()+1,o=calDate.getFullYear(),r=monthArray[calDate.getMonth()],n=r.substring(0,3),l=weekdayList[calDate.getDay()],c=l.substring(0,3);if(outDate=calDateFormat,-1!=calDateFormat.indexOf("DD")?(a=makeTwoDigit(a),outDate=jsReplace(outDate,"DD",a)):-1!=calDateFormat.indexOf("dd")&&(outDate=jsReplace(outDate,"dd",a)),-1!=calDateFormat.indexOf("MM")?(t=makeTwoDigit(t),outDate=jsReplace(outDate,"MM",t)):-1!=calDateFormat.indexOf("mm")&&(outDate=jsReplace(outDate,"mm",t)),-1!=calDateFormat.indexOf("yyyy"))outDate=jsReplace(outDate,"yyyy",o);else if(-1!=calDateFormat.indexOf("yy")){var i=(i=""+o).substring(2,4);outDate=jsReplace(outDate,"yy",i)}else-1!=calDateFormat.indexOf("YY")&&(outDate=jsReplace(outDate,"YY",o));-1!=calDateFormat.indexOf("Month")?outDate=jsReplace(outDate,"Month",r):-1!=calDateFormat.indexOf("month")?outDate=jsReplace(outDate,"month",r.toLowerCase()):-1!=calDateFormat.indexOf("MONTH")&&(outDate=jsReplace(outDate,"MONTH",r.toUpperCase())),-1!=calDateFormat.indexOf("Mon")?outDate=jsReplace(outDate,"Mon",n):-1!=calDateFormat.indexOf("mon")?outDate=jsReplace(outDate,"mon",n.toLowerCase()):-1!=calDateFormat.indexOf("MON")&&(outDate=jsReplace(outDate,"MON",n.toUpperCase())),-1!=calDateFormat.indexOf("Weekday")?outDate=jsReplace(outDate,"Weekday",l):-1!=calDateFormat.indexOf("weekday")?outDate=jsReplace(outDate,"weekday",l.toLowerCase()):-1!=calDateFormat.indexOf("WEEKDAY")&&(outDate=jsReplace(outDate,"WEEKDAY",l.toUpperCase())),-1!=calDateFormat.indexOf("Wkdy")?outDate=jsReplace(outDate,"Wkdy",c):-1!=calDateFormat.indexOf("wkdy")?outDate=jsReplace(outDate,"wkdy",c.toLowerCase()):-1!=calDateFormat.indexOf("WKDY")&&(outDate=jsReplace(outDate,"WKDY",c.toUpperCase())),calDateField.value=outDate,calDateField.focus(),top.newWin.close()}"Netscape"==navigator.appName?isNav=!0:isIE=!0,selectedLanguage=navigator.language,buildCalParts();